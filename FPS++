# Run as Administrator!
Write-Host "üõ†Ô∏è FPS Boost Script Starting..." -ForegroundColor Cyan

# Set power plan to High Performance
powercfg -setactive SCHEME_MIN
Write-Host "‚úîÔ∏è Power plan set to High Performance"

# Disable visual effects for performance
$performanceKey = "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects"
Set-ItemProperty -Path $performanceKey -Name "VisualFXSetting" -Value 2
Write-Host "‚úîÔ∏è Visual effects set to performance mode"

# Disable Xbox Game Bar &amp; DVR (causes stutter for some users)
Set-ItemProperty -Path "HKCU:\System\GameConfigStore" -Name "GameDVR_Enabled" -Value 0
Set-ItemProperty -Path "HKLM:\SOFTWARE\Policies\Microsoft\Windows\GameDVR" -Name "AllowGameDVR" -Value 0
Write-Host "‚úîÔ∏è Game DVR and Xbox Game Bar disabled"

# Clean temp files
Write-Host "üßπ Cleaning temp files..."
Remove-Item "$env:TEMP\*" -Recurse -Force -ErrorAction SilentlyContinue
Remove-Item "C:\Windows\Temp\*" -Recurse -Force -ErrorAction SilentlyContinue
Write-Host "‚úîÔ∏è Temp files cleaned"

# Stop unnecessary background services (only safe ones)
$services = @(
    "SysMain",  # Superfetch (not needed for gaming)
    "DiagTrack",  # Connected User Experiences and Telemetry
    "WSearch"  # Windows Search
)
foreach ($service in $services) {
    Stop-Service -Name $service -Force -ErrorAction SilentlyContinue
    Set-Service -Name $service -StartupType Disabled
    Write-Host "‚úîÔ∏è Service $service disabled"
}

Write-Host "`nüéÆ All tweaks applied! Reboot your PC for best results." -ForegroundColor Green
